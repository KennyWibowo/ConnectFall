!function(a){console.log(a);var b=a.module("connectFall",[]);b.config(function(a){a.resourceUrlWhitelist(["self","https://kennywibowo.github.io/**"])}).controller("GameController",["$scope","$rootScope",function(a,b){function c(a){for(var c=b.height-2;c>=0;c--)for(var d=0;d<b.width;d++)next=a[c+1][d],curr=a[c][d],next.value==b.default_type&&(next.setValue(curr.value),curr.setValue(b.default_type))}function d(){var c=(b.turn-1)%b.player_enum.length,d=b.turn%b.player_enum.length;return b.turn++,a.current_player=b.player_enum[c],a.next_player=b.player_enum[d],a.$apply(),a.current_player}function e(a,b,c){a[0][c].setValue(b)}function g(a){for(var c=0;c<b.height;c++)if(b.board[c][a].value==b.default_type)return!0;return!1}function h(b,c){a.alertType=b,a.message=c,a.$apply()}function k(){b.turn=1,a.current_player=null,a.next_player=b.player_enum[b.turn-1],a.$apply(),h("info",null)}function l(){for(var a=0;a<b.height;a++)for(var c=0;c<b.width;c++)b.board[a][c].setValue(b.default_type),b.board[a][c].$apply()}function m(a){return a.charAt(0).toUpperCase()+a.slice(1)}function n(a,c,d){return d!=b.default_type&&(a<=b.height-4&&b.board[a+1][c].value==d&&b.board[a+2][c].value==d&&b.board[a+3][c].value==d||(c<=b.width-4&&b.board[a][c+1].value==d&&b.board[a][c+2].value==d&&b.board[a][c+3].value==d||(a<=b.height-4&&c<=b.width-4&&b.board[a+1][c+1].value==d&&b.board[a+2][c+2].value==d&&b.board[a+3][c+3].value==d||a<=b.height-4&&c>=3&&b.board[a+1][c-1].value==d&&b.board[a+2][c-2].value==d&&b.board[a+3][c-3].value==d)))}function o(){for(i=0;i<b.height;i++)for(j=0;j<b.width;j++)if(n(i,j,b.board[i][j].value))return b.board[i][j].value;return!1}b.height=6,b.width=7,b.turn=1,b.status_enum=["empty","red","blue"],b.player_enum=b.status_enum.splice(1),b.default_type=b.status_enum[0],b.board=[],a.current_player=null,a.next_player=b.player_enum[b.turn-1],a.alertType=null,a.message=null,a.getNumber=function(a){num_arr=new Array(a);for(var b=0;b<a;b++)num_arr[b]=b;return num_arr},b.registerTile=function(a,c,d){a==b.board.length&&b.board.push([]),b.board[a][c]=d},b.nextTurn=function(f,i){if(o())return k(),void l();if(g(i)){h("info",null);var j=d();c(b.board),e(b.board,j,i);var n=o();n&&h("success","Victory! "+m(n)+" wins! (Click board to reset)")}else h("danger","Error: Invalid move!");a.$apply()}}]).directive("connectFall",function(){return{replace:!0,templateUrl:"https://kennywibowo.github.io/ConnectFall/templates/board.html"}}).directive("cfTile",function(){return{scope:{tileRow:"=",tileCol:"="},restrict:"E",template:"<img class='cf-tile' ng-src='{{res_value}}'>",controller:["$scope","$rootScope",function(a,b){a.value=b.default_type,a.setValue=function(b){a.value=b,a.res_value="https://kennywibowo.github.io/ConnectFall/res/tile_"+b+".png"},a.setValue(a.value),a.init=function(c,d,e){b.registerTile(d,e,a),c.addEventListener("click",function(){b.nextTurn(d,e)})}}],link:function(a,b,c,d){a.init(b[0],a.tileRow,a.tileCol)}}})}(window.angular);
